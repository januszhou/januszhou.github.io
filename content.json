{"meta":{"title":"Janus's Blog","subtitle":"Free to look around","description":"Free to look around","author":"Janus Zhou","url":"http://januszhou.tech"},"pages":[{"title":"categories","date":"2017-04-20T02:30:35.000Z","updated":"2017-04-19T22:32:44.000Z","comments":false,"path":"categories/index.html","permalink":"http://januszhou.tech/categories/index.html","excerpt":"","text":""},{"title":"","date":"2017-04-19T22:30:08.000Z","updated":"2017-04-19T22:30:08.000Z","comments":false,"path":"tags/index.html","permalink":"http://januszhou.tech/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Cpanel Composer","slug":"Cpanel-Composer","date":"2017-03-24T02:06:39.000Z","updated":"2017-04-20T15:45:30.000Z","comments":true,"path":"2017/03/23/Cpanel-Composer/","link":"","permalink":"http://januszhou.tech/2017/03/23/Cpanel-Composer/","excerpt":"","text":"cPanel suhosin issueIf you use cpanel and suhosin, you might get error as 123The suhosin.executor.include.whitelist setting is incorrect.Add the following to the end of your `php.ini` or suhosin.ini (Example path [for Debian]: /etc/php5/cli/conf.d/suhosin.ini): suhosin.executor.include.whitelist = phar You have two options to solve it, one is update php.ini file if you have the permission, the other one is add -d option as php -d suhosin.executor.include.whitelist=phar every time you need composer. StepsThe following code will do the work on 2nd method1234php -r &quot;copy(&apos;https://getcomposer.org/installer&apos;, &apos;composer-setup.php&apos;);&quot;php -r &quot;if (hash_file(&apos;SHA384&apos;, &apos;composer-setup.php&apos;) === &apos;669656bab3166a7aff8a7506b8cb2d1c292f042046c5a994c43155c0be6190fa0355160742ab2e1c88d40d5be660b410&apos;) &#123; echo &apos;Installer verified&apos;; &#125; else &#123; echo &apos;Installer corrupt&apos;; unlink(&apos;composer-setup.php&apos;); &#125; echo PHP_EOL;&quot;php -d suhosin.executor.include.whitelist=phar composer-setup.phpphp -r &quot;unlink(&apos;composer-setup.php&apos;);&quot; Then you can start enjoy composer 1php -d suhosin.executor.include.whitelist=phar /path/to/composer.phar install","categories":[{"name":"cPanel","slug":"cPanel","permalink":"http://januszhou.tech/categories/cPanel/"}],"tags":[{"name":"cPanel","slug":"cPanel","permalink":"http://januszhou.tech/tags/cPanel/"}],"keywords":[{"name":"cPanel","slug":"cPanel","permalink":"http://januszhou.tech/categories/cPanel/"}]},{"title":"Prevent HTML5 Video Seeking","slug":"Prevent-HTML5-Video-Seeking","date":"2017-03-21T04:31:01.000Z","updated":"2017-04-19T22:38:36.000Z","comments":true,"path":"2017/03/21/Prevent-HTML5-Video-Seeking/","link":"","permalink":"http://januszhou.tech/2017/03/21/Prevent-HTML5-Video-Seeking/","excerpt":"Problem on IOS If you don't want user skip part of video on HTML web page, you probably want disable controls on Video tag. However, on IOS, even you disable it, QuickPlay will still shows progress bar. Following code demonstrate how to do it.","text":"Problem on IOS If you don't want user skip part of video on HTML web page, you probably want disable controls on Video tag. However, on IOS, even you disable it, QuickPlay will still shows progress bar. Following code demonstrate how to do it. HTML 123&lt;video id=&quot;video&quot; controls autoplay muted&gt; &lt;source src=&quot;https://vjs.zencdn.net/v/oceans.mp4&quot; type=&quot;video/mp4&quot;&gt;&lt;/video&gt; JS 1234567891011121314151617181920212223var video = document.getElementById(&apos;video&apos;);var supposedCurrentTime = 0;video.addEventListener(&apos;timeupdate&apos;, function() &#123; if (!video.seeking) &#123; supposedCurrentTime = video.currentTime; &#125;&#125;);// prevent user from seekingvideo.addEventListener(&apos;seeking&apos;, function() &#123; // guard agains infinite recursion: // user seeks, seeking is fired, currentTime is modified, seeking is fired, current time is modified, .... var delta = video.currentTime - supposedCurrentTime; // delta = Math.abs(delta); // disable seeking previous content if you want if (delta &gt; 0.01) &#123; video.currentTime = supposedCurrentTime; &#125;&#125;);video.addEventListener(&apos;ended&apos;, function() &#123; // reset state in order to allow for rewind supposedCurrentTime = 0;&#125;); var video = document.getElementById('video'); var supposedCurrentTime = 0; var maxProgressTime = 0; video.addEventListener('timeupdate', function() { if (!video.seeking) { if(video.currentTime > maxProgressTime){ maxProgressTime = video.currentTime; } supposedCurrentTime = video.currentTime; } }); // prevent user from seeking video.addEventListener('seeking', function() { // console.log('Current time', video.currentTime ); // guard agains infinite recursion: // user seeks, seeking is fired, currentTime is modified, seeking is fired, current time is modified, .... var delta = video.currentTime - supposedCurrentTime; // if (delta > 0.01 || video.currentTime >= maxProgressTime) { // // console.log(\"Seeking is disabled\"); // // if(video.currentTime >= maxProgressTime){ // video.currentTime = maxProgressTime; // } else { // video.currentTime = supposedCurrentTime; // } // } if (delta > 0.01) { // console.log(\"Seeking is disabled\"); video.currentTime = supposedCurrentTime; } }); // delete the following event handler if rewind is not required video.addEventListener('ended', function() { // reset state in order to allow for rewind // supposedCurrentTime = 0; });","categories":[],"tags":[{"name":"HTML5","slug":"HTML5","permalink":"http://januszhou.tech/tags/HTML5/"},{"name":"Video","slug":"Video","permalink":"http://januszhou.tech/tags/Video/"}],"keywords":[]},{"title":"SSH Auto","slug":"SSH-Auto-List","date":"2017-03-12T03:52:58.000Z","updated":"2017-03-11T23:13:08.000Z","comments":true,"path":"2017/03/11/SSH-Auto-List/","link":"","permalink":"http://januszhou.tech/2017/03/11/SSH-Auto-List/","excerpt":"","text":"Pick SSH from your listCheck out my repository, ssh-auto","categories":[],"tags":[{"name":"SSH","slug":"SSH","permalink":"http://januszhou.tech/tags/SSH/"},{"name":"VIM","slug":"VIM","permalink":"http://januszhou.tech/tags/VIM/"}],"keywords":[]},{"title":"Wget & SFTP Examples","slug":"WGET-SFTP-example","date":"2017-03-02T03:57:47.000Z","updated":"2017-03-11T23:13:22.000Z","comments":true,"path":"2017/03/01/WGET-SFTP-example/","link":"","permalink":"http://januszhou.tech/2017/03/01/WGET-SFTP-example/","excerpt":"","text":"StoryMy company needs grab files from 3rd party servers daily and only today’s file. Here are useful snippets of FTP and SFTP. Wget From FTPIf you need wget download specific file from another server, there is accept list argument -A that helps us filter today’s file. 12today=$(date +&quot;%Y-%m-%d&quot;)wget --user=&apos;ROOT&apos; --password=&apos;PWD&apos; -r --no-parent -A &quot;File $today*&quot; ftp://ftp.server.com/ -O ./destination.csv SFTPFor SFTP, once you have public key installed on their server, you can do the following12345today=$(date +&quot;%Y-%m-%d&quot;)sftp name@server.com &lt;&lt;EOFget *$today* destination.csv // name the file as destination.csvquitEOF","categories":[],"tags":[{"name":"WGET","slug":"WGET","permalink":"http://januszhou.tech/tags/WGET/"},{"name":"SFTP","slug":"SFTP","permalink":"http://januszhou.tech/tags/SFTP/"}],"keywords":[]},{"title":"CasperJS and Parallel","slug":"CasperJS-and-Parallel","date":"2017-02-12T01:50:24.000Z","updated":"2017-04-19T22:31:44.000Z","comments":true,"path":"2017/02/11/CasperJS-and-Parallel/","link":"","permalink":"http://januszhou.tech/2017/02/11/CasperJS-and-Parallel/","excerpt":"Trouble on CasperJSOne of the project we need use CasperJS to navigates dozens URLs, evaluate hundreds lines of javascript in that page then submit the form, sounds crazy right?!","text":"Trouble on CasperJSOne of the project we need use CasperJS to navigates dozens URLs, evaluate hundreds lines of javascript in that page then submit the form, sounds crazy right?! Unfortunately, even we tried our best to optimize the page loading performance, the whole process is take around one hour. We tried initialize multiple instances of CasperJS and running those at same time, but it still failed. However, we found this blog, by utilizing Parallel, program ables to process CasperJS under multiple threads simultaneously, the following steps similar to that blog except I will list installation parts. Check CPU coresMake sure your server has more than 1 core… 12Mac: # sysctl -n hw.ncpuLinux: # nproc Install CasperJS1234567// install phantoms 2.1.1# wget https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-2.1.1-linux-x86_64.tar.bz2# tar xvf phantomjs-2.1.1-linux-x86_64.tar.bz2# cp phantomjs-2.1.1-linux-x86_64/bin/phantomjs /usr/bin# phantomjs -v# 2.1.1# npm install -g casperjs Install Parallel123cd /etc/yum.repos.d/wget http://download.opensuse.org/repositories/home:/tange/CentOS_CentOS-6/home:tange.repoyum install parallel ExamplesImagine you will need a list URLs like below and named as list.txt, or generate it by yourself. 1234https://google.comhttps://yahoo.comhttps://facebook.com... Then you can use the following command to process those URLs simultaneously. 1parallel --bar -a list.txt casperjs process.js HTTP RedirectIf the URL is being forced redirect from http to https, you probably will get redirect and won’t get anything, in this case, add --ignore-ssl-errors=true --ssl-protocol=any to your command.","categories":[{"name":"CasperJS","slug":"CasperJS","permalink":"http://januszhou.tech/categories/CasperJS/"}],"tags":[{"name":"CasperJS","slug":"CasperJS","permalink":"http://januszhou.tech/tags/CasperJS/"},{"name":"Parallel","slug":"Parallel","permalink":"http://januszhou.tech/tags/Parallel/"},{"name":"PhantomJS","slug":"PhantomJS","permalink":"http://januszhou.tech/tags/PhantomJS/"}],"keywords":[{"name":"CasperJS","slug":"CasperJS","permalink":"http://januszhou.tech/categories/CasperJS/"}]},{"title":"Apache SSH","slug":"Apache-SSH","date":"2017-01-22T03:22:12.000Z","updated":"2017-04-19T22:31:13.000Z","comments":true,"path":"2017/01/21/Apache-SSH/","link":"","permalink":"http://januszhou.tech/2017/01/21/Apache-SSH/","excerpt":"","text":"Test SSH under Apache roleIf you need PHP to process bash script, and it need SSH to another server process something else. Example PHP snippet: $bash = shell_exec(&#39;bash ./example.sh&#39;);. Because PHP running under Apache, so Apache needs SSH to correct server. However, Ubuntu prevent su apache for obvious security reason, but you still able to change it.1sudo vim /etc/passwd After find role Apache, change /sbin/nologin to /bin/login. Now you can do su apache. Under Apache role, test your SSH host, you need add host to your trust list for first time. You probably want create ssh_config file under /var/www/. Don’t forget update Apache to /sbin/nologin after it.","categories":[{"name":"Apache","slug":"Apache","permalink":"http://januszhou.tech/categories/Apache/"}],"tags":[{"name":"Apache","slug":"Apache","permalink":"http://januszhou.tech/tags/Apache/"},{"name":"SSH","slug":"SSH","permalink":"http://januszhou.tech/tags/SSH/"},{"name":"PHP","slug":"PHP","permalink":"http://januszhou.tech/tags/PHP/"}],"keywords":[{"name":"Apache","slug":"Apache","permalink":"http://januszhou.tech/categories/Apache/"}]},{"title":"PHP & MSSQL","slug":"PHP-MSSQL","date":"2016-12-12T03:11:07.000Z","updated":"2017-03-11T23:17:24.000Z","comments":true,"path":"2016/12/11/PHP-MSSQL/","link":"","permalink":"http://januszhou.tech/2016/12/11/PHP-MSSQL/","excerpt":"Using MSSQL On PHP7Recently, one of my clients needs pull data from one of his new provider, unexpectedly, this new provider use MSSQL, however, we upgraded from php5.6 to php7, the old mssql_connect function is being removed at php7, read more here, we need another solution for it.","text":"Using MSSQL On PHP7Recently, one of my clients needs pull data from one of his new provider, unexpectedly, this new provider use MSSQL, however, we upgraded from php5.6 to php7, the old mssql_connect function is being removed at php7, read more here, we need another solution for it. SybaseThe solution is using PDO to handle connection, but before it, we need install Sybase dependency. Below is working perfectly fine with Ubuntu 14.04.1sudo apt-get install php7.0-sybase PDOAfter it installed correctly, you can use the code below to connect with MSSQL12345678910$myServer = &quot;xxx.xxx.xxx.xxx&quot;;$myUser = &quot;myUser&quot;;$myPass = &quot;myPass&quot;;$myDB = &quot;myDB&quot;;$dsn= &quot;dblib:host=$myServer:1433;&quot;;$mspdo = new PDO($dsn,$myUser,$myPass);$mspdo-&gt;setAttribute(PDO::ATTR_ERRMODE,PDO::ERRMODE_EXCEPTION);$query = &apos;SELECT * FROM &#123;your desired table&#125;&apos;;$result = $mspdo-&gt;query($query)-&gt;fetchAll(PDO::FETCH_ASSOC); PHP5 + SybaseHere is the code will works for php5, you need install sudo apt-get install php5-sybase, you could use the example below to handle the query. Read more here 123456$dbhandle = mssql_connect($myServer, $myUser, $myPass);$query = &apos;Some Query&apos;;$result = mssql_query($query);while ($row = mssql_fetch_assoc($result)) &#123; echo &apos;&lt;li&gt;&apos; . $row[&apos;name&apos;] . &apos; (&apos; . $row[&apos;username&apos;] . &apos;)&lt;/li&gt;&apos;;&#125;","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://januszhou.tech/tags/PHP/"},{"name":"MSSQL","slug":"MSSQL","permalink":"http://januszhou.tech/tags/MSSQL/"}],"keywords":[]},{"title":"Homestead Auto Add New Site","slug":"Homestead-add-new-site","date":"2016-11-15T23:11:58.000Z","updated":"2017-03-11T23:13:37.000Z","comments":true,"path":"2016/11/15/Homestead-add-new-site/","link":"","permalink":"http://januszhou.tech/2016/11/15/Homestead-add-new-site/","excerpt":"","text":"Add New Site To HomesteadIf you using Homestead as your development environment, you should know how to add a new site manually. But I find it a little bit annoying that you have type same commands every time. I started search around and try to find any bash script can do same thing for me in one command, I found this in Github, someone has created nice bash script can do pretty much everything, but it really out-of-date, so I cloned the repo and update a little bit here CatchYou need update configuration at top of bash script.","categories":[],"tags":[{"name":"Homestead","slug":"Homestead","permalink":"http://januszhou.tech/tags/Homestead/"},{"name":"Bash","slug":"Bash","permalink":"http://januszhou.tech/tags/Bash/"}],"keywords":[]},{"title":"Hexo Server Auto Restart","slug":"auto-restart-hexo-server","date":"2016-10-19T04:59:23.000Z","updated":"2017-04-19T22:31:31.000Z","comments":true,"path":"2016/10/19/auto-restart-hexo-server/","link":"","permalink":"http://januszhou.tech/2016/10/19/auto-restart-hexo-server/","excerpt":"","text":"Introduce Hexo Auto RestartHexo is a great blog platform, the article you are looking right now is written on top of Hexo. If you tired manually to Ctrl + c start and restart server, you probably want two console window, one runs hexo server -s, -s means only serve static html files, which located at public/ folder, and the other one runs hexo generate --watch, it’s builtin command to watch file updates and auto generate new static files. Start those two commands, refresh your browser and you should see the new updates. Problem With Watch in VagrantBoxI personally had pretty much all developing projects running in the vagrant box, the problem of hexo generate --watch seems like doesn’t corporate with vagrant box, so the Nodemon comes into the game. Install NodemonI prefer install Nodemon globally, [sudo] npm install -g nodemon, but if you don’t like it, just do npm install nodemon Magic CommandCommand: nodemon -e html,md,less --ignore public/ -L --exec &#39;hexo generate&#39;, The Nodemon will start watching file updates and automatically runs hexo generate Short explanation: -e is adding the specific extension to Nodemon watch list, nodemon default looks for files with .js, .coffee, .litcoffee and .json, on this example, Nodemon will watch .html, .md. Add whatever extensions you want. -L is only required if you running your developing environment on virtual machine, such as Vagrant, VirtualBox. --ignore public/ is important, otherwise, once you generated new static files, Nodemon will detect updates in public folder and start generate again, infinite loop… --exec &#39;hexo generate&#39; is the main command let Nodemon knows how suppose it to execute the program, inside hexo server, you can change it to whatever you currently using, for more information, check at Hexo Server FinallyOn production, you could consider to use forever to start Hexo daemon, the command I use is1forever start --uid blog --append -c &apos;hexo server -s -p 80&apos; ./ After you get new blog and pull from upstream, run hexo generate and your blog should get updated.","categories":[{"name":"Hexo","slug":"Hexo","permalink":"http://januszhou.tech/categories/Hexo/"}],"tags":[{"name":"Hexo","slug":"Hexo","permalink":"http://januszhou.tech/tags/Hexo/"},{"name":"Nodemon","slug":"Nodemon","permalink":"http://januszhou.tech/tags/Nodemon/"}],"keywords":[{"name":"Hexo","slug":"Hexo","permalink":"http://januszhou.tech/categories/Hexo/"}]},{"title":"Youtube video snapshot with play button","slug":"youtube-snapshot-with-play-button","date":"2016-10-11T19:00:00.000Z","updated":"2017-04-19T22:43:22.000Z","comments":true,"path":"2016/10/11/youtube-snapshot-with-play-button/","link":"","permalink":"http://januszhou.tech/2016/10/11/youtube-snapshot-with-play-button/","excerpt":"Why I created this tool Recently, one of my clients ask me to put their newest marketing video snapshot with play button into the new email campaign. Obviously, if I'm the designer, I would just use Photoshop, but I'm not... So I made a tool myself.","text":"Why I created this tool Recently, one of my clients ask me to put their newest marketing video snapshot with play button into the new email campaign. Obviously, if I'm the designer, I would just use Photoshop, but I'm not... So I made a tool myself. Load Youtube YouTube Video Take screenshot anytime you want $(document).ready(function(){ // Get handles on the video and canvas elements var video = document.querySelector('video'); video.autoplay = false; var canvas = document.querySelector('canvas'); // Get a handle on the 2d context of the canvas element var context = canvas.getContext('2d'); // Define some vars required later var w, h, ratio; var spinner; function spinStart(){ var target = document.getElementById('loader'); spinner = new Spinner(); target.appendChild(spinner.spin().el); } function spinStop(){ spinner.stop(); } function getParameterByName(name, url) { if (!url) url = window.location.href; name = name.replace(/[\\[\\]]/g, \"\\\\$&\"); var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"), results = regex.exec(url); if (!results) return null; if (!results[2]) return ''; return decodeURIComponent(results[2].replace(/\\+/g, \" \")); } /** * Test case 12h34m5s, 12h77m5s, 12h34m77s, 12h34h5s, 12h34m5m, 5s, 34m5s * @param {[String]} t [description] * @return {[type]} [description] */ function convert(t) { //format could be 1h2m3s var results = t.split(/(h|m|s)/g); var hour = minute = second = 0; if(results.length == 1){ return 0; } var foundHour = foundMinute = foundSecond = 0; for(var i = 0; i 1 || foundMinute > 1 || foundSecond > 1){ return 0; } if(minute >= 60 || second >= 60){ return 0; } return hour * 3600 + minute * 60 + second; } $('#load-youtube').on('click', function(){ spinStart(); var src = $('#youtube-link').val(); var t = getParameterByName('t', src); var jump = 0; if(t){ jump = convert(t); } if (src) { var isYoutube = src && src.match(/(?:youtu|youtube)(?:\\.com|\\.be)\\/([\\w\\W]+)/i); if (isYoutube) { var id = isYoutube[1].match(/watch\\?v=|[\\w\\W]+/gi); id = (id.length > 1) ? id.splice(1) : id; id = id.toString(); var mp4url = \"http://www.youtubeinmp4.com/redirect.php?video=\"; // if need hd, do hd=1 video.src = mp4url + id; if(jump){ video.currentTime = jump; } // Add a listener to wait for the 'loadedmetadata' state so the video's dimensions can be read video.addEventListener('loadedmetadata', function() { // Calculate the ratio of the video's width to height ratio = video.videoWidth / video.videoHeight; // Define the required width as 100 pixels smaller than the actual video's width w = video.videoWidth; // Calculate the height based on the video's width and the ratio h = parseInt(w / ratio, 10); // Set the canvas width and height to the values just calculated canvas.width = w; canvas.height = h; spinStop(); }, false); setTimeout(function(){ spinStop(); }, 5000); } else { alert('Valid youtube link please'); spinStop(); } } else { spinStop(); } }); $('#snap').on('click', function(){ // Define the size of the rectangle that will be filled (basically the entire element) context.fillRect(0, 0, w, h); // Grab the image from the video context.drawImage(video, 0, 0, w, h); var playImage = new Image(); playImage.src = $('input[name=play-button]:checked').parent().find('img').prop('src'); playImage.onload = function(){ var paddingX = parseInt((w - playImage.width) / 2); var paddingY = parseInt((h - playImage.height) / 2); context.drawImage(playImage, paddingX, paddingY); } }) })","categories":[],"tags":[{"name":"Youtube","slug":"Youtube","permalink":"http://januszhou.tech/tags/Youtube/"},{"name":"Canvas","slug":"Canvas","permalink":"http://januszhou.tech/tags/Canvas/"}],"keywords":[]},{"title":"Laravel Sever Setup On EC2","slug":"larvel-server-setup","date":"2016-10-05T00:43:28.000Z","updated":"2016-10-20T20:50:33.000Z","comments":true,"path":"2016/10/04/larvel-server-setup/","link":"","permalink":"http://januszhou.tech/2016/10/04/larvel-server-setup/","excerpt":"Laravel Server SetupEnvironment setup on EC2, Linux ubuntu 14.04 + php 5.6 + mysql 5.7 + apache 2.4","text":"Laravel Server SetupEnvironment setup on EC2, Linux ubuntu 14.04 + php 5.6 + mysql 5.7 + apache 2.4 PHP1234sudo apt-get -y updatesudo add-apt-repository ppa:ondrej/phpsudo apt-get -y updatesudo apt-get -y install php5.6 php5.6-mcrypt php5.6-mbstring php5.6-curl php5.6-cli php5.6-mysql php5.6-gd php5.6-intl php5.6-xsl Git &amp; Zip1sudo apt-get install zip unzip git ###Mysql 5.712345wget http://dev.mysql.com/get/mysql-apt-config_0.6.0-1_all.debsudo dpkg -i mysql-apt-config_0.6.0-1_all.debsudo apt-get updatesudo apt-get install mysql-server mysql-clientthen select 5.7 ###Redis123sudo add-apt-repository ppa:chris-lea/redis-serversudo apt-get updatesudo apt-get install redis-server ComposerFollow instruction on website, then 1mv composer.phar /usr/local/bin/composer Apache12sudo a2enmod rewritesudo service apache2 restart ###Install Laravel dependencies123composer installchmod 777 bootstrap/cachechmod 777 -R storage","categories":[],"tags":[{"name":"server-setup","slug":"server-setup","permalink":"http://januszhou.tech/tags/server-setup/"},{"name":"EC2","slug":"EC2","permalink":"http://januszhou.tech/tags/EC2/"},{"name":"Laravel","slug":"Laravel","permalink":"http://januszhou.tech/tags/Laravel/"}],"keywords":[]}]}